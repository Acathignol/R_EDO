rm(list=ls())

library(deSolve)

LVpeypred=function(t,x,parms)
{
  dx1=parms[1]*x[1]-parms[2]*x[1]*x[2] #Proie=N=x1 et prédateurs=P=x2 ET parms1=r ,parms2=a, parms3=e et parms4=m
  dx2=parms[2]*parms[3]*x[1]*x[2]-parms[4]*x[2]
  list(dx1)
  list(dx2)
}

temps=seq(0,100,by=0.1)

init1=c(5)
init2=c(20)
init3=c(10)

r1=2
K1=20
E1=0.1
solution1=lsoda(y=init1,times=temps,func=LVpeypred,parms=c(r1,K1,E1))

E2=0.1
solution2=lsoda(y=init2,times=temps,func=LVpeypred,parms=c(r1,K1,E2))

E3=0.1
solution3=lsoda(y=init3,times=temps,func=LVpeypred,parms=c(r1,K1,E3))


par(mfrow=c(2,1))
curve(2*x*(1-(x/300))-0.1*x^2,col=2,xlim=c(-5,30),ylim=c(-3,15),
      main="Modèle de population exploitée pour différentes valeurs de E",ylab="dN/dt",xlab="N")
abline(h=0,lty=2)
curve(2*x*(1-(x/300))-0.2*x^2,col=3,add=T)
curve(2*x*(1-(x/300))-0.5*x^2,col=4,add=T)
legend("topright",legend=c("E=0.1","E=0.2","E=0.5"),lty=1,col=c(2,3,4))

plot(temps,solution1[,2],ylim=c(0,20),xlim=c(0,5),type="l",
     ylab="Densité de population (N)",
     main="Modèle de Population exploitée")
lines(temps,solution2[,2],type="l",col=2)
lines(temps,solution3[,2],type="l",col=3)
legend("topright",legend=c("N0=5","N0=20","N0=10"),col=c(1,2,3),lty=1)
