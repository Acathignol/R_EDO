rm(list=ls())

Eq5=function(t,x,parms)
{
  dx1=parms[1]*x[1]*(1-(x[1]/parms[2]))-parms[3]
  list(dx1)
}

temps=seq(0,10,by=1)

init=c(20,50,200,400)

r1=2
K1=300
Q1=10
solution1=lsoda(y=init[1],times=temps,func=Eq5,parms=c(r1,K1,Q1))
solution2=lsoda(y=init[2],times=temps,func=Eq5,parms=c(r1,K1,Q1))
solution3=lsoda(y=init[3],times=temps,func=Eq5,parms=c(r1,K1,Q1))
solution4=lsoda(y=init[4],times=temps,func=Eq5,parms=c(r1,K1,Q1))


par(mfrow=c(2,1))
curve(2*x*(1-(x/300))-10,col=1,xlim=c(-5,400),ylim=c(-100,150),
      main="Modèle de population exploitée pour différentes valeurs de Q",ylab="dN/dt",xlab="N")
abline(h=0,lty=2)
curve(2*x*(1-(x/300))-100,col=2,add=T)
curve(2*x*(1-(x/300))-150,col=3,add=T)
curve(2*x*(1-(x/300))-200,col=4,add=T)
legend("topright",legend=c("Q=10","Q=100","Q=150","Q=200"),lty=1,col=c(1,2,3,4))


plot(temps,solution1[,2],ylim=c(0,500),xlim=c(0,10),type="l",
     ylab="Densité de population (N)",
     main="Modèle de Population exploitée")
lines(temps,solution2[,2],type="l",col=2)
lines(temps,solution3[,2],type="l",col=3)
lines(temps,solution4[,2],type="l",col=4)
legend("topright",legend=c("N0=5","N0=20","N0=50","N0=100"),col=c(1,2,3,4),lty=1)

